<!DOCTYPE html>
<html>

<head>
  <title>WebChat</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font: 13px Helvetica, Arial;
    }

    form {
      background: #000;
      padding: 3px;
      position: fixed;
      bottom: 0;
      width: 100%;
    }

    form input {
      border: 0;
      padding: 10px;
      width: 90%;
      margin-right: 0.5%;
    }

    form button {
      width: 9%;
      background: rgb(130, 224, 255);
      border: none;
      padding: 10px;
      cursor: pointer;
    }

    #mensagens {
      list-style-type: none;
      margin: 0;
      padding: 0;
    }

    #mensagens li {
      padding: 5px 10px;
    }

    #mensagens li:nth-child(odd) {
      background: #eee;
    }
  </style>
  <title>WebChat</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.0.4/socket.io.js"></script>
</head>

<body>

  <input type="text" id="nickname-box" data-testid="nickname-box" placeholder="Digite seu apelido...">
  <button id='nicknameButton' data-testid="nickname-button">Salvar</button>

  <input type="text" id="message-box" data-testid="message-box" placeholder="Digite sua mensagem...">
  <button id="send-button" data-testid="send-button">Enviar</button>

  <h2>Usu√°rios</h2>
  <div>
    <ul id="users">
      <% users.forEach(({ nickname, socketId })=> { %>
        <li class="online-user2" data-testid="online-user" id=<%=socketId %> ><%= nickname %>
        </li>
        <% }) %>
    </ul>
  </div>
</body>

<script>
  const socket = io('http://localhost:3000');

  const button = document.querySelector('#send-button');
  const message = document.querySelector('#message-box');
  const nickname = document.querySelector('#nickname-box');

  const renderUser = () => {
    socket.emit('connected', { nickname: nickname.value });
    socket.emit('message', { nickname: nickname.value, chatMessage: message.value });
    message.value = '';
    return false;
  }

  button.addEventListener('click', renderUser);
</script>

</html>